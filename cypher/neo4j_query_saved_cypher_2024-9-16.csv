name,description,query,id,parentId,isFolder
salonauto,,,0,,true
Discover data,,"LOAD CSV WITH HEADERS FROM ""https://raw.githubusercontent.com/nrouyer/caroftheyear2024/main/dataset/table_caroftheyear_links_votedetails.csv"" AS row
RETURN row LIMIT 10",1,0,false
Nominated cars,,"LOAD CSV WITH HEADERS FROM ""https://raw.githubusercontent.com/nrouyer/caroftheyear2024/main/dataset/table_caroftheyear_links_votedetails.csv"" AS row
UNWIND keys(row) AS keyRow
with keyRow where not keyRow IN [""Name"", ""Link"", ""VoteDetails"", ""Country""]
WITH DISTINCT keyRow
RETURN keyRow AS car",2,0,false
Constraints,,"CREATE CONSTRAINT jury_name IF NOT EXISTS FOR (jury:Jury) REQUIRE (jury.name) IS NODE KEY;
CREATE CONSTRAINT ranking_link IF NOT EXISTS FOR (ranking:Ranking) REQUIRE (ranking.link) IS NODE KEY;
CREATE CONSTRAINT car_name IF NOT EXISTS FOR (car:Car) REQUIRE (car.name) IS NODE KEY;",3,0,false
Load data,,,4,0,true
Load Jury nodes,,"LOAD CSV WITH HEADERS FROM ""https://raw.githubusercontent.com/nrouyer/caroftheyear2024/main/dataset/table_caroftheyear_links_votedetails.csv"" AS row
MERGE (jury:Jury {name: row.Name})
RETURN count (jury);",5,4,false
Load Car nodes,,"LOAD CSV WITH HEADERS FROM ""https://raw.githubusercontent.com/nrouyer/caroftheyear2024/main/dataset/table_caroftheyear_links_votedetails.csv"" AS row
UNWIND keys(row) AS keyRow
with distinct keyRow where not keyRow IN [""Name"", ""Link"", ""VoteDetails"", ""Country""]
MERGE (car:Car {name: keyRow})
RETURN count(car);",6,4,false
Load Ranking nodes,,"LOAD CSV WITH HEADERS FROM ""https://raw.githubusercontent.com/nrouyer/caroftheyear2024/main/dataset/table_caroftheyear_links_votedetails.csv"" AS row
WITH row WHERE row.Link is not null
MERGE (ranking:Ranking {link: row.Link}) 
  ON CREATE SET ranking.voteDetails = row.VoteDetails
  ON MATCH SET ranking.voteDetails = row.VoteDetails
RETURN count(ranking);",7,4,false
Relationships Jury GIVES Ranking,,"LOAD CSV WITH HEADERS FROM ""https://raw.githubusercontent.com/nrouyer/caroftheyear2024/main/dataset/table_caroftheyear_links_votedetails.csv"" AS row
WITH row WHERE row.Link is not null
MATCH (ranking:Ranking {link: row.Link}) 
MATCH (jury:Jury {name: row.Name})
MERGE (jury)-[gives:GIVES]->(ranking)
RETURN count(gives);",8,4,false
Relationships Ranking TO Car,,"MATCH (car:Car)
WITH collect (car.name) AS listOfCars
LOAD CSV WITH HEADERS FROM ""https://raw.githubusercontent.com/nrouyer/caroftheyear2024/main/dataset/table_caroftheyear_links_votedetails.csv"" AS row
WITH listOfCars, row WHERE row.Link is not null 
MATCH (ranking:Ranking {link: row.Link}) 
WITH listOfCars, ranking, row
UNWIND keys(row) AS keyRow
WITH listOfCars, ranking, row, keyRow WHERE keyRow in listOfCars
MATCH (car:Car {name: keyRow})
MERGE (ranking)-[to:TO]->(car)
  ON CREATE SET to.score = toInteger(row[keyRow])
  ON MATCH SET to.score = toInteger(row[keyRow])
RETURN count(to);",9,4,false